function ajaxRssData(){function e(){$("#feed .previewContainer").hover(function(){$(".prevImage",this).length>0&&$(this).addClass("hov")},function(){$(this).removeClass("hov")}),$("#feed .previewContainer").each(function(){$("a",this).attr("href")==window.location.href&&($(".previewContainer").removeClass("active"),$(this).addClass("active"))})}function a(){function e(e){var a=$(window).height()-1-e;$("#filters").css({height:e}),$("#feed").css({height:a})}var a=$("#filters").height();e(a),$(window).resize(function(){var t=$("input[name=radios]:radio:checked").attr("id");"radio1"==t?e(a):"radio2"==t?e($("#tags").outerHeight()+a):"radio3"==t&&e($("#search").outerHeight()+a)}),$("input[name=radios]:radio").change(function(){"radio1"==$(this).attr("id")&&($("#options #search input").val(""),t.all(),t.onComplete(),e(a)),"radio2"==$(this).attr("id")&&($("#options #search input").val(""),$("#tags .ajaxTagLink").removeClass("active"),e($("#tags").outerHeight()+a)),"radio3"==$(this).attr("id")&&(e($("#search").outerHeight()+a),""!==$("#search input").val()&&t.find($("#search input").val()))})}var t=$("#search input").ghostHunter({results:"#feed",displaySearchInfo:!0,zeroResultsInfo:!0,result_template:'   <div class="previewContainer {{noImg}}">                                <a class ="ajaxLink" href="{{link}}">                                    {{img}}                                    <div class="content">                                        <div class="dot"></div>                                        <div class="dateStamp">{{pubDate}}</div>                                             <h1 class="postTitle">{{title}}</h1>                                     </div>                                </a>                            </div>',info_template:' <div class="noResults">                            <div class="content">                                <h1 class="postTitle">Number of posts found: {{amount}}</h1>                             </div>                        </div>',onComplete:function(){e(),$("#feed .previewContainer").each(function(){$("a",this).attr("href")==window.location.href&&($(".previewContainer").removeClass("active"),$(this).addClass("active"))})},onReady:function(){e(),$.each(t.listTags,function(e,a){$("<li></li>").html('<a class="ajaxTagLink" href="/tag/'+a.replace(/\s+/g,"-").toLowerCase()+'">'+a+"</a>").appendTo(".listTags ul")}),$(".ajaxTagLink").click(function(){$("#mainNavCheck").prop("checked",!1),$('#mainNav input[type="checkbox"]').prop("checked",!1)})}});$("body").on("click","#tags .ajaxTagLink",function(e){e.preventDefault();var a="tag-"+$(this).text().replace(/\s+/g,"-").toLowerCase()+"-tag";t.find(a),$("#tags .ajaxTagLink").removeClass("active"),$(this).addClass("active")}),t.all(),a()}function navBarSetup(){function e(){""!==$("#mainNav input").val()&&($("body").addClass("showNewsFeedSearch"),$("#mainNavCheck").prop("checked",!1),$('#mainNav input[type="checkbox"]').prop("checked",!1),$("#mainNav input").blur(),$("#search input").val($("#mainNav input").val()),$("#filters #radio3").prop("checked",!0),$("#filters #radio3").change())}function a(){$("body").removeClass("showNewsFeedSearch"),$(".post-template").length<1&&($("#filters #radio1").prop("checked",!0),$("#filters #radio1").change(),$("#options #search input").val("")),$("#mainNav input").val("")}$.fn.pressEnter=function(e){return this.each(function(){$(this).bind("enterPress",e),$(this).keyup(function(e){13==e.keyCode&&$(this).trigger("enterPress")})})},$("#mainNav input").pressEnter(function(){e()}),$("#mainNav .menu").on("click",function(){a()}),$("#sideBar").mouseleave(function(){a()})}function checkShowNewsFeed(){$(".post-template").length>0&&$(".page").length<1&&showNewsFeed===!0?($("body").addClass("showNewsFeed"),$("#mainNavCheck").addClass("trigger"),window.setTimeout(function(){$("#mainNavCheck").removeClass("trigger")},400)):$("body").removeClass("showNewsFeed")}function featureSection(e,a,t){function o(){$(".featuredContainer").addClass("show"),$("#wookmark .item:lt("+t+")").appendTo(".featuredContainer .featureContent"),i();new featureSlider($(".featuredContainer"))}function n(){$(".featuredContainer").addClass("show"),$("#wookmark .featured").appendTo(".featuredContainer .featureContent"),$("#wookmark .featured").remove(),i();new featureSlider($(".featuredContainer"))}function i(){$(".featuredContainer .subHeroImage img").length>=1&&$(".featuredContainer .item").each(function(){var e=$(".subHeroImage img",this).attr("src");$(".subHeroImage",this).css({"background-image":"url('"+e+"' )"})})}$(".home-template").length>0&&(e===!0?a===!0?$("#wookmark .featured").length>0?n():o():a===!1&&$("#wookmark .featured").length>0&&n():a===!0&&latestNum>0&&o())}function homepageLayout(e){function a(a){e=a,1==e?($("#wookmark .item:odd").addClass("verticle"),t()):2==e?($("#wookmark .item").addClass("verticle"),t()):3==e&&($("#wookmark .item").addClass("verticle"),t())}function t(){$(".wookmarkWrap .verticle").each(function(){if($(".subHeroImage img",this).length>=1&&-1!=$(".subHeroImage img",this).attr("src").indexOf("#hero")){var e=$(".subHeroImage img",this).attr("src");1==wookmarkLayout&&$(".subHeroImage",this).css({"background-image":"url('"+e+"' )"}),2==wookmarkLayout&&($(".subHeroImage img",this).height()>$(".subHeroImage img",this).width()?$(".subHeroImage",this).css({"background-image":"url('"+e+"' )"}):$(this).removeClass("verticle")),3==wookmarkLayout&&$(".subHeroImage",this).css({"background-image":"url('"+e+"' )"})}else $(".subHeroImage p",this).remove(),$(".subHeroImage",this).html(""),$(this).addClass("noHeroImage"),$(this).removeClass("verticle")})}a($("html").hasClass("mq")?e:4),wookmarkfunction()}function renderPageHeroImage(){$("#postMain").length>0&&$(".postContent img").length>0&&$(".postContent img").each(function(){if($(this).attr("src").indexOf("#hero")>=0){$("#postMain .heroImage").addClass("showHeroImage");var e=$(this).attr("src");$("#postMain .heroImage").css({"background-image":"url('"+e+"' )"}),$(this).addClass("hidden")}$(this).attr("src").indexOf("#thumb")>=0&&$(this).addClass("hidden")})}function postColType(){var e=$("#postMain .postContent");e.find("div").hasClass("singleColumn")?(e.first().removeClass("doubleColumn"),e.first().addClass("singleColumn")):$("#postMain .postContent div").hasClass("doubleColumn")&&(e.removeClass("singleColumn"),e.first().addClass("doubleColumn"))}function scrollFadeIn(e){function a(){var a=$($(window).height()>0?window:"#container");window.setTimeout(function(){e.each(function(e){$(this).offset().top<a.height()+a.scrollTop()&&$(this).delay(100*e).fadeTo("normal",1)})},200)}a(),$("#container").on("scroll",a),$("#postMain").on("scroll",a)}function wookmarkfunction(){function e(){var e=t.width(),a={itemWidth:350,outerOffset:20};490>=e?(a.itemWidth="100%",a.outerOffset=0):(a.itemWidth=350,a.outerOffset=20),o.wookmark(a)}var a={itemWidth:350,autoResize:!0,container:$("#wookmark"),offset:20,direction:"left",align:"left",outerOffset:20,flexibleWidth:"100%"},t=$($(window).width()>0?window:"#container"),o=$("#wookmark .item");t.resize(function(){e(),scrollFadeIn($("#wookmark article"))}),o.wookmark(a),e(),$(".item").css({visibility:"visible"})}function paginationSetup(){var e=$(".pag").data("page");1==e&&($(".pag .ajaxNewerPosts").remove(),$(".ajaxNewerPosts, .ajaxOlderPosts").addClass("ajaxPag"),$(".pag .ajaxOlderPosts").html("Load More"))}function gmaps(){if($("#gmaps").length>0){var e,a,t=$("#gmaps"),o=t.data("lat"),n=t.data("lng"),i=new google.maps.LatLng(o,n),r="gmaps";a={center:i,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP},e=new google.maps.Map(document.getElementById(r),a);var s=new google.maps.Marker({position:i});s.setMap(e)}}function supportCheck(){jQuery("html").addClass(Modernizr.mq("only all")?"mq":"no-mq"),$("body").append('<div id="supportCheck"><input type="radio" name="test" checked="checked" id="id-test" /></div>'),"200px"!==$("#supportCheck input").css("width")&&$("html").addClass("no-checked"),$("#supportCheck input").css("width")>="200px"&&$("html").addClass("checked")}function RUNlegacySupport(){try{legacySupportIE(),$(".ie7icoMoon").remove(),icomoon()}catch(e){}}function ajaxPageData(){function e(e){var a=$(e),t=$("#mainContainer",a).contents(),n=$("#container");n.fadeOut(500,function(){$("body").attr("class",$("#container",a).attr("class")),$("#container").scrollTop(0),o.html(""),o.show().html(t),$(".postContent").fitVids(),$(".home-template").length>0&&featureSection(feature,latest,latestNum),t.css({opacity:0}),i=1,r=$(".pag").data("totalPages"),checkShowNewsFeed(),gmaps(),postColType(),window.setTimeout(function(){if($(".home-template, .tag-template, .archive-template, .author-template").length>0){try{$("#wookmark").imagesLoaded(function(){homepageLayout(wookmarkLayout)})}catch(e){homepageLayout(wookmarkLayout)}paginationSetup(),$("#wookmark article").css({opacity:0}),scrollFadeIn($("#wookmark article"))}else{try{Prism.highlightAll()}catch(e){}renderPageHeroImage()}$("#container").css({opacity:0}).fadeTo(500,1),RUNlegacySupport(),$("#feed .previewContainer").each(function(){$("a",this).attr("href")==window.location.href&&($(".previewContainer").removeClass("active"),$(this).addClass("active"))}),NProgress.done(),loading=!1},560)})}function a(e){function a(){window.setTimeout(function(){var e=$("#container #postMain").length>0?"#postMain":"#container",a=$(".page"+i).offset().top+$(e).scrollTop();$(e).stop().animate({scrollTop:a-20},800)},400)}var o=(t.getState(),$(e)),n=$("#wookmark",o).contents(),s=$(".wookmarkWrap .pagination",o).html();if(r>i&&(i+=1),r>=i){i>=r&&$(".pag .ajaxOlderPosts").fadeOut(),$(".wookmarkWrap .pagination").empty(),$(".wookmarkWrap .pagination").append(s),$(".wookmarkWrap .pagination").css({opacity:0}).fadeTo(500,1),$(n).addClass("page"+i),$("#wookmark").append(n),$("#wookmark .page"+i).css({opacity:0}),scrollFadeIn($("#wookmark .page"+i));try{$("#wookmark").imagesLoaded(function(){homepageLayout(wookmarkLayout),a(),paginationSetup()})}catch(c){homepageLayout(wookmarkLayout),a(),paginationSetup()}RUNlegacySupport(),$(n).css({opacity:0})}NProgress.done(),loading=!1}var t=window.History,o=$("#mainContainer"),n={result:"",append:!1,stateChangeIsLocal:!1},i=$(".pag").data("page"),r=$(".pag").data("totalPages");return t.enabled?(t.Adapter.bind(window,"statechange",function(){var o=t.getState();n.stateChangeIsLocal?(n.append?(a(n.result),n.append=!1):e(n.result),n.stateChangeIsLocal=!1):$.get(o.url,function(t){loading=!0,NProgress.start(),n.append?(a(t),n.append=!1):e(t)}).fail(function(){window.alert("Error. Page may not exist or you have lost internet connection."),NProgress.done(),loading=!1})}),void $("body").on("click",".dateStamp a, .ajaxLink, .ajaxPag, #mainNav .ajaxTagLink, .tags a",function(e){function a(e,a){$.get(e,function(o){loading=!0,NProgress.start(),n={append:a,result:o,stateChangeIsLocal:!0};var i=o.match(/<title>(.*?)<\/title>/);t.pushState({},i[1],e)}).fail(function(){window.alert("Error. Page may not exist or you have lost internet connection."),NProgress.done(),loading=!1})}if(e.preventDefault(),loading===!1){var o=t.getState(),i=$(this).attr("href"),r=($(document).attr("title")||null,$(this).hasClass("ajaxPag"));i.replace(/^.*\/\/[^\/]+/,"")!==o.url.replace(/^.*\/\/[^\/]+/,"")&!r?a(i,!1):r?a(i,!0):($("#container").animate({scrollTop:0}),NProgress.start(),NProgress.done())}})):!1}var feature=!0,latest=!0,latestNum=3,sliderWait=5e3,wookmarkLayout=2,showNewsFeed=!0;checkShowNewsFeed(),loading=!0,NProgress.start(),$(function(){function e(){try{$("#wookmark").imagesLoaded(function(){$("#wookmark article").css({opacity:0}),homepageLayout(wookmarkLayout),scrollFadeIn($("#wookmark article")),NProgress.done(),loading=!1})}catch(e){homepageLayout(wookmarkLayout),NProgress.done(),loading=!1}}function a(){$("#mainNavCheck").prop("checked",!0),$('#mainNav .autoExpand input[type="checkbox"]').prop("checked",!0)}function t(){$("#mainNavCheck").prop("checked",!1),$('#mainNav input[type="checkbox"]').prop("checked",!1)}$("#container").delay(500).css({opacity:0}).fadeTo(500,1),postColType(),supportCheck(),$("body").removeClass("preload"),$(".share").removeClass("preload"),navBarSetup(),$(".home-template,.tag-template, .author-template, .archive-template").length>0?(paginationSetup(),featureSection(feature,latest,latestNum),window.setTimeout(e,600)):(renderPageHeroImage(),gmaps(),NProgress.done(),loading=!1),$(".postContent").fitVids();try{ajaxRssData()}catch(o){}ajaxPageData(),$(".ajaxLink, .ajaxTagLink").click(function(){t()}),$("#sideBar li.openMenu span").click(function(){$("#mainNavCheck").prop("checked",!0)}),$("#sideBar .menu").click(function(){$("#mainNavCheck").is(":checked")?$('#mainNav input[type="checkbox"]').prop("checked",!1):$('#mainNav .autoExpand input[type="checkbox"]').prop("checked",!0)}),$("#sideBar nav").hover(function(){a()},function(){t()})});var featureInterval,featureSlider=function(e){function a(e,a){function o(e,a){var o=t.find("article").eq(a);t.find("."+e+" .hoverPrev .subHeroImage").html(o.find(".subHeroImage").clone()),t.find("."+e+" .hoverPrev .postTitle").html(o.find(".postTitle").clone()),t.find("."+e+" .hoverPrev .dateStamp").html(o.find(".dateStamp").clone())}o("left",e),o("right",a)}window.clearInterval(featureInterval);var t=e,o=0,n=t.find("article").last().index()-1,i=o;if(o==n)t.find("#controls").remove();else for(var r=0;n>=r;r++)t.find(".pagination").append('<div class="dot"></div>');t.find(".pagination .dot").eq(o).addClass("dotCurrent"),t.find(".featureContent article .imageContain").removeAttr("href"),t.find(".featureContent article .postTitle a").removeAttr("href");var s=function(e,a){i=e,t.find("article").removeClass("current"),t.find("article").eq(e).addClass("current"),t.find(".pagination .dot").removeClass("dotCurrent"),t.find(".pagination .dot").eq(e).addClass("dotCurrent"),void 0!==a&&a()};window.setTimeout(function(){s(o,a(n,o+1))},10),s.next=function(){if(i+1>n)s(o,a(n,o+1));else{var e=i+1,t=e+1>n?o:e+1;s(e,a(i,t))}},s.prev=function(){if(o>i-1)s(n,a(n-1,o));else{var e=i-1,t=o>e-1?n:e-1;s(e,a(t,i))}},s.clicked=function(e){(e!=o||e!=n)&&s(e,a(e-1,e+1)),e==o&&s(e,a(n,e+1)),e==n&&s(e,a(e-1,o))},t.find("#controls .right").on("click",function(){s.next()}),t.find("#controls .left").on("click",function(){s.prev()}),t.find(".pagination .dot").on("click",function(){s.clicked($(this).index())}),featureInterval=window.setInterval(function(){s.next()},sliderWait),t.on("mouseenter",function(){window.clearInterval(featureInterval)}),t.on("mouseleave",function(){window.clearInterval(featureInterval),featureInterval=window.setInterval(function(){s.next()},sliderWait)})},loading=!1;
